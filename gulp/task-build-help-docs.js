/*jslint node: true */
/*jshint esversion: 6 */

module.exports.registerTask = function(gulp){
	
	const args = require('yargs').argv
        , type = args.offline ? 'offline' : 'online'
    ;

    const tasks = {
        offline: [
            'clean-working-folders',        // clean folders where generated content is placed
            'toc',                          // toc task to build chm.xml
            'asciidoc',                     // render AsciiDoc files as HTML (respects build flags and resolves build variables)
            'sync-file-system-to-toc',      // removes any files on the file system on listed in the TOC (saves us from indexing shared docs not officially in a help set)
            'copyImages',                   // copies images from the repository
            'offlineResources',             // copies scripts and styles needed for offline publishing
            'copy-api-files',               // copies API HTML files as generated by DocumentX
            'rename',                       // renmames files and handles Japanese encoding if necessary
            'copy-offline-files'            // copies all html, images and TOC files to a folder named 'offline' in prep CHM generation
        ],
        online: [
            'asciidoc',                     // render AsciiDoc files as HTML (respects build flags and resolves build variables)
            'sync-file-system-to-toc',      // removes any files on the file system on listed in the TOC (saves us from indexing shared docs not officially in a help set)
            'copyImages',                   // copies images from the repository
            'copy-api-files',               // copies API HTML files as generated by DocumentX
            'sitemap',                      // generates sitemaps for products
            'solrIndex',                    // indexes the content for the solr search engine
            'copy-online-files'             // copies all html, images and TOC files to a folder named 'online' in prep for mounting on the webserver
        ]
    };
    
    gulp.task('build-help-docs', tasks[type]);
};